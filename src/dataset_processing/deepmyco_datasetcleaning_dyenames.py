# -*- coding: utf-8 -*-
"""DeepMyco-DatasetCleaning-DyeNames.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Tim_ZWuBMdz5CdwT0NYguEyTe2W_08th
"""

# =========================================
# 1. Setup & load data
# =========================================
import pandas as pd
import os

# OPTION A: If your file is in Google Drive
# from google.colab import drive
# drive.mount('/content/drive')
# folder_path = "/content/drive/MyDrive/DeepMyco"  # <-- change to your folder
# input_path = os.path.join(folder_path, "merged_dataset.csv")

# OPTION B: If your file is in the Colab working directory
input_path = "/content/merged_dataset.csv"  # <-- change if needed

df = pd.read_csv(input_path)

if "type_of_dye" not in df.columns:
    raise ValueError("Column 'type_of_dye' not found in the dataset.")

print("Unique dye names BEFORE cleaning:", df["type_of_dye"].nunique())
print(df["type_of_dye"].value_counts().head(20))

# =========================================
# 2. Define mapping: variant -> canonical
#    (You can extend/edit this as needed.)
# =========================================

dye_mapping = {
    # Crystal Violet
    "Crystal Violet": "Crystal Violet",
    "Crystal violet": "Crystal Violet",
    "crystal violet": "Crystal Violet",
    "crystal violet (decolorized supernatant)": "Crystal Violet",

    # Methyl Red
    "Methyl Red": "Methyl Red",
    "Methyl red": "Methyl Red",
    "methyl red": "Methyl Red",

    # Malachite Green
    "Malachite Green": "Malachite Green",
    "Malachite green": "Malachite Green",
    "malachite green": "Malachite Green",

    # Congo Red
    "Congo Red": "Congo Red",
    "Congo red": "Congo Red",
    "congo red": "Congo Red",

    # Amido Black
    "Amido Black": "Amido Black",
    "Amido black": "Amido Black",
    "amido black": "Amido Black",

    # Brilliant Green
    "Brilliant Green": "Brilliant Green",
    "Brilliant green": "Brilliant Green",
    "brilliant green": "Brilliant Green",

    # Methylene Blue
    "Methylene Blue": "Methylene Blue",
    "Methylene blue": "Methylene Blue",
    "methylene blue": "Methylene Blue",

    # Orange II
    "Orange II": "Orange II",
    "orange II": "Orange II",

    # Reactive Black 5
    "Reactive Black 5": "Reactive Black 5",
    "Reactive black 5": "Reactive Black 5",

    # Indigo Carmine
    "Indigo Carmine": "Indigo Carmine",
    "Indigo carmine": "Indigo Carmine",
    "indigo carmine": "Indigo Carmine",

    # Methyl Orange
    "Methyl Orange": "Methyl Orange",
    "Methyl orange": "Methyl Orange",
    "methyl orange": "Methyl Orange",

    # p-Cresol
    "p-Cresol": "p-Cresol",
    "p-cresol": "p-Cresol",

    # o-Cresol
    "o-Cresol": "o-Cresol",
    "o-cresol": "o-Cresol",

    # Phenol
    "Phenol": "Phenol",
    "phenol": "Phenol",

    # Acid Orange 7
    "Acid Orange 7": "Acid Orange 7",
    "Acid orange 7": "Acid Orange 7",

    # Remazol Brilliant Blue R
    "Remazol Brilliant Blue R": "Remazol Brilliant Blue R",
    "Remazol Brilliant Blue R (RBBR)": "Remazol Brilliant Blue R",
    "remazol brilliant blue R": "Remazol Brilliant Blue R",

    # Reactive Blue 19
    "Reactive Blue 19": "Reactive Blue 19",
    "Reactive blue 19": "Reactive Blue 19",

    # Bismarck brown
    "Bismarck brown": "Bismarck brown",
    "bismarck brown": "Bismarck brown",

    # Azo dye variants
    "Azo dye": "Azo dye",
    "azo dye": "Azo dye",
    "Azo dye (Orange II)": "Azo dye",
    "Azo Dye (Amido Black)": "Azo dye",

    # Mixed Triphenylmethane Dyes
    "Mixed Triphenylmethane Dyes": "Mixed Triphenylmethane Dyes",
    "Mixed triphenylmethane dyes": "Mixed Triphenylmethane Dyes",
    "mixed triphenylmethane dyes": "Mixed Triphenylmethane Dyes",

    # Combined dyes (many detailed variants collapsed)
    "Combined dyes": "Combined dyes",
    "combined dyes": "Combined dyes",
    "Combined Dyes (including Amido Black)": "Combined dyes",
    "Combined dyes (Brilliant Green, Basic Fuchsin, Malachite Green)": "Combined dyes",
    "Combined dyes (Brilliant Green, Basic Fuchsin, Malachite Green, Crystal Violet)": "Combined dyes",
    "combined dyes (crystal violet + brilliant green + basic fuchsin + malachite green)": "Combined dyes",
    "combined dyes (crystal violet + others)": "Combined dyes",

    # 2,6-Dimethoxyphenol
    "2,6-Dimethoxyphenol": "2,6-Dimethoxyphenol",
    "2,6-dimethoxyphenol (DMP)": "2,6-Dimethoxyphenol",

    # Cresol Red
    "Cresol Red": "Cresol Red",
    "Cresol red": "Cresol Red",

    # Azure B
    "Azure B": "Azure B",
    "azure B": "Azure B",

    # Basic Fuchsin
    "Basic Fuchsin": "Basic Fuchsin",
    "Basic fuchsin": "Basic Fuchsin",
    "basic fuchsin": "Basic Fuchsin",
}

# =========================================
# 3. Apply mapping (and basic normalization)
# =========================================

# Optional: strip whitespace before mapping
df["type_of_dye"] = df["type_of_dye"].astype(str).str.strip()

# Apply the mapping
df["type_of_dye_clean"] = df["type_of_dye"].replace(dye_mapping)

# If you want to overwrite the original column, uncomment:
# df["type_of_dye"] = df["type_of_dye"].replace(dye_mapping)

# =========================================
# 4. Inspect changes
# =========================================
print("\nUnique dye names AFTER cleaning (using 'type_of_dye_clean'):")
print(df["type_of_dye_clean"].nunique())
print(df["type_of_dye_clean"].value_counts().head(30))

# Show some examples where the name changed
changed = df[df["type_of_dye"] != df["type_of_dye_clean"]][["type_of_dye", "type_of_dye_clean"]].drop_duplicates()
print("\nExamples of changed names:")
print(changed.head(50))

# =========================================
# 5. Save cleaned file
# =========================================

# If you mounted Drive and used folder_path:
# output_path = os.path.join(folder_path, "merged_dataset_dyes_cleaned.csv")

output_path = "/content/merged_dataset_dyes_cleaned.csv"  # <-- adjust if needed
df.to_csv(output_path, index=False)

print(f"\nâœ… Saved cleaned dataset to: {output_path}")